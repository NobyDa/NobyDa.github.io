<!doctype html>
<html lang="zh"><head><meta charset="utf-8"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta><title>è®°å½•ä¸€æ¬¡Surge &amp; QuantumultX è„šæœ¬å¼€å‘è¿‡ç¨‹ - NobyDa&#039;s Blog</title><link rel="manifest" href="/manifest.json"><meta name="application-name" content="NobyDa&#039;s Blog"><meta name="msapplication-TileImage" content="img/avatar.png"><meta name="apple-mobile-web-app-capable" content="yes"><meta name="apple-mobile-web-app-title" content="NobyDa&#039;s Blog"><meta name="apple-mobile-web-app-status-bar-style" content="default"><meta name="description" content="å‰è¨€ æœ¬æ–‡ä¸»è¦è®°å½•ä¸€æ¬¡Surgeæˆ–QuantumultXçš„è„šæœ¬å¼€å‘è¿‡ç¨‹, è¿‡ç¨‹åŒ…æ‹¬æŠ“åŒ…ã€åˆ†æã€è°ƒè¯•ã€ä»¥åŠç¼–å†™è„šæœ¬.  è®°å½•å†…å®¹ä¸ºå“”å“©å“”å“©æ¼«ç”»ç§¯åˆ†å•†åŸè‡ªåŠ¨æŠ¢åˆ¸è„šæœ¬."><meta property="og:type" content="blog"><meta property="og:title" content="è®°å½•ä¸€æ¬¡Surge &amp; QuantumultX è„šæœ¬å¼€å‘è¿‡ç¨‹"><meta property="og:url" content="https://nobyda.github.io/2021/07/16/BilibiliManga_Js_example/"><meta property="og:site_name" content="NobyDa&#039;s Blog"><meta property="og:description" content="å‰è¨€ æœ¬æ–‡ä¸»è¦è®°å½•ä¸€æ¬¡Surgeæˆ–QuantumultXçš„è„šæœ¬å¼€å‘è¿‡ç¨‹, è¿‡ç¨‹åŒ…æ‹¬æŠ“åŒ…ã€åˆ†æã€è°ƒè¯•ã€ä»¥åŠç¼–å†™è„šæœ¬.  è®°å½•å†…å®¹ä¸ºå“”å“©å“”å“©æ¼«ç”»ç§¯åˆ†å•†åŸè‡ªåŠ¨æŠ¢åˆ¸è„šæœ¬."><meta property="og:locale" content="zh_CN"><meta property="og:image" content="https://nobyda.github.io/gallery/BilibiliManga_Js_example.jpg"><meta property="article:published_time" content="2021-07-16T12:30:00.000Z"><meta property="article:modified_time" content="2021-07-17T10:06:42.564Z"><meta property="article:author" content="NobyDa"><meta property="article:tag" content="Surge"><meta property="article:tag" content="QuantumultX"><meta property="article:tag" content="JavaScript"><meta property="twitter:card" content="summary"><meta property="twitter:image" content="/gallery/BilibiliManga_Js_example.jpg"><script type="application/ld+json">{"@context":"https://schema.org","@type":"BlogPosting","mainEntityOfPage":{"@type":"WebPage","@id":"https://nobyda.github.io/2021/07/16/BilibiliManga_Js_example/"},"headline":"NobyDa","image":["https://nobyda.github.io/gallery/BilibiliManga_Js_example.jpg"],"datePublished":"2021-07-16T12:30:00.000Z","dateModified":"2021-07-17T10:06:42.564Z","author":{"@type":"Person","name":"NobyDa"},"publisher":{"@type":"Organization","name":"NobyDa's Blog","logo":{"@type":"ImageObject","url":"https://nobyda.github.io/2021/07/16/BilibiliManga_Js_example/img/logo.svg"}},"description":"å‰è¨€ æœ¬æ–‡ä¸»è¦è®°å½•ä¸€æ¬¡Surgeæˆ–QuantumultXçš„è„šæœ¬å¼€å‘è¿‡ç¨‹, è¿‡ç¨‹åŒ…æ‹¬æŠ“åŒ…ã€åˆ†æã€è°ƒè¯•ã€ä»¥åŠç¼–å†™è„šæœ¬.  è®°å½•å†…å®¹ä¸ºå“”å“©å“”å“©æ¼«ç”»ç§¯åˆ†å•†åŸè‡ªåŠ¨æŠ¢åˆ¸è„šæœ¬."}</script><link rel="canonical" href="https://nobyda.github.io/2021/07/16/BilibiliManga_Js_example/"><link rel="icon" href="/img/avatar.png"><link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.15.2/css/all.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/highlight.js@9.12.0/styles/atom-one-light.css"><link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Ubuntu:wght@400;600&amp;family=Source+Code+Pro"><link rel="stylesheet" href="/css/default.css"><style>body>.footer,body>.navbar,body>.section{opacity:0}</style><!--!--><!--!--><!--!--><script src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js" defer></script><!--!--><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/css/lightgallery.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/css/justifiedGallery.min.css"><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/pace-js@1.0.2/pace.min.js"></script><!--!--><!--!--><meta name="generator" content="Hexo 5.4.0"></head><body class="is-2-column"><nav class="navbar navbar-main"><div class="container"><div class="navbar-brand justify-content-center"><a class="navbar-item navbar-logo" href="/"><img src="/img/logo.svg" alt="NobyDa&#039;s Blog" height="28"></a></div><div class="navbar-menu"><div class="navbar-start"><a class="navbar-item" href="/">ä¸»é¡µ</a><a class="navbar-item" href="/archives">å½’æ¡£</a><a class="navbar-item" href="/categories">åˆ†ç±»</a><a class="navbar-item" href="/tags">æ ‡ç­¾</a></div><div class="navbar-end"><a class="navbar-item is-hidden-tablet catalogue" title="ç›®å½•" href="javascript:;"><i class="fas fa-list-ul"></i></a><a class="navbar-item search" title="æœç´¢" href="javascript:;"><i class="fas fa-search"></i></a></div></div></div></nav><section class="section"><div class="container"><div class="columns"><div class="column order-2 column-main is-8-tablet is-9-desktop is-9-widescreen"><div class="card"><div class="card-image"><span class="image is-7by3"><img class="fill" src="/gallery/BilibiliManga_Js_example.jpg" alt="è®°å½•ä¸€æ¬¡Surge &amp; QuantumultX è„šæœ¬å¼€å‘è¿‡ç¨‹"></span></div><article class="card-content article" role="article"><div class="article-meta is-size-7 is-uppercase level is-mobile"><div class="level-left"><span class="level-item"><time dateTime="2021-07-16T12:30:00.000Z" title="2021/7/16 20:30:00">2021-07-16</time>å‘è¡¨</span><span class="level-item"><time dateTime="2021-07-17T10:06:42.564Z" title="2021/7/17 18:06:42">2021-07-17</time>æ›´æ–°</span><span class="level-item"><a class="link-muted" href="/categories/%E8%84%9A%E6%9C%AC%E5%BC%80%E5%8F%91/">è„šæœ¬å¼€å‘</a></span><span class="level-item">28 åˆ†é’Ÿè¯»å®Œ (å¤§çº¦4218ä¸ªå­—)</span><span class="level-item" id="busuanzi_container_page_pv"><span id="busuanzi_value_page_pv">0</span> æ¬¡æµè§ˆ</span></div></div><h1 class="title is-3 is-size-4-mobile">è®°å½•ä¸€æ¬¡Surge &amp; QuantumultX è„šæœ¬å¼€å‘è¿‡ç¨‹</h1><div class="content"><h1 id="å‰è¨€"><a href="#å‰è¨€" class="headerlink" title="å‰è¨€"></a>å‰è¨€</h1><ol>
<li><p>æœ¬æ–‡ä¸»è¦è®°å½•ä¸€æ¬¡Surgeæˆ–QuantumultXçš„è„šæœ¬å¼€å‘è¿‡ç¨‹, è¿‡ç¨‹åŒ…æ‹¬æŠ“åŒ…ã€åˆ†æã€è°ƒè¯•ã€ä»¥åŠç¼–å†™è„šæœ¬.</p>
</li>
<li><p>è®°å½•å†…å®¹ä¸ºå“”å“©å“”å“©æ¼«ç”»ç§¯åˆ†å•†åŸè‡ªåŠ¨æŠ¢åˆ¸è„šæœ¬.</p>
</li>
</ol>
<span id="more"></span>

<h1 id="èƒŒæ™¯"><a href="#èƒŒæ™¯" class="headerlink" title="èƒŒæ™¯"></a>èƒŒæ™¯</h1><p>ä½œä¸ºä¸€ä¸ªåˆæ ¼çš„äºŒæ¬¡å…ƒè¿·, æ¼«ç”»å½“ç„¶æ˜¯å°‘ä¸äº†ğŸ§</p>
<p>å›½å†…æ—¥æ¼«å¤§å¤šéƒ½è¢«å“”å“©å“”å“©æ¼«ç”»æ‹¿ä¸‹ç‰ˆæƒ, ç„¶è€Œé‡Œé¢å¤§å¤šæ•°çš„æ—¥æ¼«éƒ½éœ€è¦æ°ªé‡‘æˆ–ä½¿ç”¨æ¼«è¯»åˆ¸æ‰èƒ½çœ‹; </p>
<p>æœ€è¿‘å‘ç°ä½¿ç”¨ç­¾åˆ°è„šæœ¬è·å¾—çš„ç§¯åˆ†å›¤å¾—å·®ä¸å¤šäº†, æ¢æ¼«è¯»åˆ¸åˆå¯ä»¥çœä¸€ç¬”, æ— å¥ˆè€æ˜¯é”™è¿‡ç›¸å…³å•†å“å…‘æ¢æ—¶é—´, ä¸€æ°”ä¹‹å†™äº†ä¸ªè„šæœ¬è®©å®ƒåœ¨è§„å®šæ—¶é—´å†…è‡ªåŠ¨æŠ¢åˆ¸.</p>
<h1 id="è¿‡ç¨‹"><a href="#è¿‡ç¨‹" class="headerlink" title="è¿‡ç¨‹"></a>è¿‡ç¨‹</h1><h2 id="ç¬¬ä¸€æ­¥-æŠ“åŒ…"><a href="#ç¬¬ä¸€æ­¥-æŠ“åŒ…" class="headerlink" title="ç¬¬ä¸€æ­¥: æŠ“åŒ…"></a>ç¬¬ä¸€æ­¥: æŠ“åŒ…</h2><p>æœ¬æ–‡å°†ä½¿ç”¨<a target="_blank" rel="noopener" href="https://apps.apple.com/app/id1210562295">Thor</a>è¿›è¡ŒæŠ“åŒ…, å¹¶ä½¿ç”¨<a target="_blank" rel="noopener" href="https://apps.apple.com/app/id1357644265">Anubis</a>è¿›è¡Œé‡æ”¾æ¼”ç¤º, ç®€å•åˆ†æå“”å“©å“”å“©æ¼«ç”»çš„ç½‘ç»œè¯·æ±‚.</p>
<p>æˆ‘ä»¬è¿›å…¥å“”å“©å“”å“©æ¼«ç”»APPå, æ‰“å¼€Thorå¼€å¯æŠ“åŒ…, è¿”å›APPç§¯åˆ†å•†åŸéšä¾¿å…‘æ¢ä¸€ä¸ªä¸œè¥¿, å†è¿”å›Thorå…³é—­æŠ“åŒ….</p>
<p>Thoræœ‰ç€å®Œå¤‡çš„å…³é”®å­—è¿‡æ»¤,  åˆšåˆšå…‘æ¢äº†75ç§¯åˆ†çš„å•†å“, æˆ‘ä»¬å¯ä»¥å°è¯•æœç´¢è¯·æ±‚ä½“å’Œå“åº”ä½“å†…çš„å…³é”®å­—, çœ‹çœ‹æ˜¯å¦æœ‰ç»“æœ.</p>
<p><img src="/2021/07/16/BilibiliManga_Js_example/thor-exchange-filter.jpg"></p>
<p>æœç´¢åä¸€ä¸ªåä¸ºPointshop/Exchangeçš„è¯·æ±‚ç›´æ¥æ˜ å…¥çœ¼ä¸‹, ç¿»è¯‘æˆä¸­æ–‡å¤§æ„ä¸º åº—é“º/å…‘æ¢, å¾ˆç›´è§‚.</p>
<p><img src="/2021/07/16/BilibiliManga_Js_example/thor-exchange-url.JPEG"></p>
<p>æˆ‘ä»¬è¿›ä¸€æ­¥æŸ¥çœ‹è¯¥è¯·æ±‚çš„è¯·æ±‚ä½“, ä»¥åŠå“åº”ä½“.</p>
<p><img src="/2021/07/16/BilibiliManga_Js_example/thor-exchange-body.JPEG"></p>
<p>å¯ä»¥å¾ˆç›´è§‚çš„çœ‹åˆ°è¯·æ±‚ä½“ä¸­çš„å„ç§å‚æ•°, product_id è¡¨ç¤ºå…‘æ¢çš„å•†å“, product_num è¡¨ç¤ºå…‘æ¢çš„æ•°é‡, point è¡¨ç¤ºæ¶ˆè€—çš„ç§¯åˆ†.</p>
<p>å“åº”ä½“ä¸­codeä¸º0è¡¨ç¤ºå…‘æ¢æˆåŠŸ, expire_dayè¡¨ç¤ºæœ‰æ•ˆæœŸ, remain_amountè¡¨ç¤ºè¯¥å•†å“åº“å­˜.</p>
<p>æˆ‘ä»¬æŠŠè¯¥è¯·æ±‚ä½¿ç”¨anubisé‡æ”¾, çœ‹çœ‹è¯¥æ¥å£æ˜¯å¦æœ‰æ•ˆ.</p>
<p><img src="/2021/07/16/BilibiliManga_Js_example/thor-exchange-anubis.JPEG"></p>
<p>å¯ä»¥çœ‹åˆ°é‡æ”¾åè¯¥æ¥å£æ˜¯å¯ç”¨çš„, å•†å“å‰©ä½™æ•°é‡ç›¸åº”å‡å°‘, è¿”å›appæŸ¥çœ‹è´¦å·ç§¯åˆ†ä¹Ÿå‡å°‘äº†75å¹¶æ”¶åˆ°å•†å“.</p>
<p>ä¹‹åæˆ‘ä»¬çœ‹ä¸€ä¸‹è¯·æ±‚ä½“ä¸­çš„product_idçš„å•†å“idæ˜¯æ€ä¹ˆæ¥çš„, è¿”å›Thorä¹‹å‰æŠ“åˆ°çš„åŒ…, ç­›é€‰å™¨æœç´¢1048å…³é”®å­—.</p>
<p><img src="/2021/07/16/BilibiliManga_Js_example/thor-exchange-list.JPEG"></p>
<p>æœç´¢åæœ‰ä¸€ä¸ªå«ListProductçš„è¯·æ±‚, ç¿»è¯‘æˆä¸­æ–‡å¤§æ„ä¸ºå•†å“æ¸…å•, æˆ‘ä»¬ç‚¹å¼€å“åº”ä½“å¯ä»¥çœ‹åˆ°ä¸€ä¸ªå•†å“åä¸ºâ€å°æ™ºæ€ªè°ˆâ€çš„å•†å“, å•†å“idä¸º1048, å•†å“åº“å­˜ä¸º3796, æ­£æ˜¯æˆ‘ä¹‹å‰æ‰€å…‘æ¢çš„å•†å“.</p>
<p>è¯¥æ¥å£ä½¿ç”¨anubisé‡æ”¾åå¹¶æ²¡æœ‰ä»€ä¹ˆé—®é¢˜; </p>
<p>æœ€åè¿˜å·®ä¸€ä¸ªæŸ¥è¯¢è´¦æˆ·ç§¯åˆ†çš„æ¥å£, æˆ‘ä»¬ä½¿ç”¨Thorç­›é€‰å™¨æœç´¢å“åº”å…³é”®å­—, å¼€å¯æŠ“åŒ…ä¹‹å‰æˆ‘çš„è´¦æˆ·æœ‰3172ç§¯åˆ†, åˆ™å°è¯•æœç´¢3172</p>
<p><img src="/2021/07/16/BilibiliManga_Js_example/thor-exchange-point.JPEG"></p>
<p>å¯ä»¥çœ‹åˆ°æœ‰ä¸€ä¸ªå«GetUserPointçš„è¯·æ±‚, ç¿»è¯‘æˆä¸­æ–‡å¤§æ„ä¸ºè·å–ç”¨æˆ·ç§¯åˆ†, ç‚¹å¼€å“åº”åæˆ‘ä»¬å¯ä»¥çœ‹åˆ°æŸ¥è¯¢åˆ°çš„è´¦æˆ·ç§¯åˆ†.</p>
<h2 id="ç¬¬äºŒæ­¥-åˆ†æ"><a href="#ç¬¬äºŒæ­¥-åˆ†æ" class="headerlink" title="ç¬¬äºŒæ­¥: åˆ†æ"></a>ç¬¬äºŒæ­¥: åˆ†æ</h2><p>æˆ‘ä»¬æŠ“åˆ°æ¥å£åä½¿ç”¨anubisé‡æ”¾è¿›ä¸€æ­¥åˆ†æ:</p>
<ol>
<li>ç²¾ç®€å‚æ•°, åˆ†æurlä¸­çš„deviceä¹‹ç±»çš„å‚æ•°æ˜¯å¦å¿…é¡»ã€æ˜¯å¦éªŒè¯Cookieã€è¯·æ±‚ä½“æ˜¯å¦å¿…é¡», ä»¥å‡å°‘è„šæœ¬ç¼–å†™å·¥ä½œé‡.</li>
<li>åˆ†æå„ç§æƒ…å†µä¸‹æ¥å£è¿”å›ä¸åŒå“åº”çš„å¯èƒ½æ€§, ä¾›è„šæœ¬æ­£ç¡®åˆ¤æ–­.</li>
</ol>
<h3 id="åˆ†ææŸ¥è¯¢ç§¯åˆ†æ¥å£"><a href="#åˆ†ææŸ¥è¯¢ç§¯åˆ†æ¥å£" class="headerlink" title="åˆ†ææŸ¥è¯¢ç§¯åˆ†æ¥å£"></a>åˆ†ææŸ¥è¯¢ç§¯åˆ†æ¥å£</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">åŸæ¥å£<br>https://manga.bilibili.com/twirp/pointshop.v1.Pointshop/GetUserPoint?device=h5&amp;platform=web<br></code></pre></td></tr></table></figure>

<p>ç»è¿‡å„ç§é‡æ”¾åå¯å¾—çŸ¥</p>
<ol>
<li>æ¥å£å¯çœç•¥urlä¸­çš„å‚æ•°.</li>
<li>è¯·æ±‚ä½“å¯çœç•¥.</li>
<li>å¿…é¡»ä½¿ç”¨POSTæ–¹æ³•.</li>
<li>ä½¿ç”¨è¯·æ±‚å¤´ä¸­çš„Cookieå­—æ®µä½œä¸ºç”¨æˆ·é‰´æƒ, ä¸€äº›éå¿…è¦å­—æ®µä¹Ÿå¯çœç•¥.</li>
</ol>
<p>å¸¦æœ‰æ•ˆCookieå“åº”ä½“å†…å®¹ä¸º</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;code&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;msg&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-attr">&quot;data&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;point&quot;</span>: <span class="hljs-string">&quot;ç”¨æˆ·å®é™…ç§¯åˆ†æ•°é‡&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<p>Cookieå¤±æ•ˆåå“åº”ä½“å†…å®¹ä¸º</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;code&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;msg&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-attr">&quot;data&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;point&quot;</span>: <span class="hljs-string">&quot;0&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="åˆ†ææŸ¥è¯¢å•†å“æ¥å£"><a href="#åˆ†ææŸ¥è¯¢å•†å“æ¥å£" class="headerlink" title="åˆ†ææŸ¥è¯¢å•†å“æ¥å£"></a>åˆ†ææŸ¥è¯¢å•†å“æ¥å£</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">åŸæ¥å£<br>https://manga.bilibili.com/twirp/pointshop.v1.Pointshop/ListProduct?device=h5&amp;platform=web<br></code></pre></td></tr></table></figure>

<p>ç»è¿‡å„ç§é‡æ”¾åå¯å¾—çŸ¥</p>
<ol>
<li>æ¥å£å¯çœç•¥urlä¸­çš„å‚æ•°.</li>
<li>è¯·æ±‚ä½“å¯çœç•¥.</li>
<li>å¿…é¡»ä½¿ç”¨POSTæ–¹æ³•.</li>
<li>æ— éœ€ç”¨æˆ·é‰´æƒ.</li>
</ol>
<p>å“åº”ä½“:</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;code&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;msg&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-attr">&quot;data&quot;</span>: [&#123;<br>    <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-number">195</span>,<br>    <span class="hljs-attr">&quot;type&quot;</span>: <span class="hljs-number">7</span>,<br>    <span class="hljs-attr">&quot;title&quot;</span>: <span class="hljs-string">&quot;ç§¯åˆ†å…‘æ¢&quot;</span>,<br>    <span class="hljs-attr">&quot;image&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-attr">&quot;amount&quot;</span>: <span class="hljs-number">15999</span>,<br>    <span class="hljs-attr">&quot;cost&quot;</span>: <span class="hljs-number">200</span>,<br>    <span class="hljs-attr">&quot;real_cost&quot;</span>: <span class="hljs-number">100</span>,<br>    <span class="hljs-attr">&quot;remain_amount&quot;</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;comic_id&quot;</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;limits&quot;</span>: [],<br>    <span class="hljs-attr">&quot;discount&quot;</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;product_type&quot;</span>: <span class="hljs-number">1</span>,<br>    <span class="hljs-attr">&quot;pendant_url&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-attr">&quot;pendant_expire&quot;</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;exchange_limit&quot;</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;address_deadline&quot;</span>: <span class="hljs-string">&quot;0001-01-01T00:00:00Z&quot;</span>,<br>    <span class="hljs-attr">&quot;act_type&quot;</span>: <span class="hljs-number">0</span>,<br>    <span class="hljs-attr">&quot;has_exchanged&quot;</span>: <span class="hljs-literal">false</span>,<br>    <span class="hljs-attr">&quot;main_coupon_deadline&quot;</span>: <span class="hljs-string">&quot;0001-01-01T00:00:00Z&quot;</span>,<br>    <span class="hljs-attr">&quot;deadline&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>    <span class="hljs-attr">&quot;point&quot;</span>: <span class="hljs-string">&quot;0&quot;</span><br>  &#125;]<br>&#125;<br></code></pre></td></tr></table></figure>

<p>ä»¥ä¸Šéå®é™…å“åº”, å…¶ä»–å•†å“è¿‡å¤š, å·²çœç•¥.</p>
<h3 id="åˆ†æå…‘æ¢å•†å“æ¥å£"><a href="#åˆ†æå…‘æ¢å•†å“æ¥å£" class="headerlink" title="åˆ†æå…‘æ¢å•†å“æ¥å£"></a>åˆ†æå…‘æ¢å•†å“æ¥å£</h3><figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">åŸæ¥å£<br>https://manga.bilibili.com/twirp/pointshop.v1.Pointshop/Exchange?device=h5&amp;platform=web<br></code></pre></td></tr></table></figure>

<p>ç»è¿‡å„ç§é‡æ”¾åå¯å¾—çŸ¥</p>
<ol>
<li><p>æ¥å£å¯çœç•¥urlä¸­çš„å‚æ•°.</p>
</li>
<li><p>è¯·æ±‚ä½“éœ€å¸¦æœ‰</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;product_id&quot;</span>: <span class="hljs-string">&quot;å•†å“ID&quot;</span>,<br>  <span class="hljs-attr">&quot;product_num&quot;</span>: <span class="hljs-string">&quot;å•†å“å…‘æ¢æ•°é‡&quot;</span>,<br>  <span class="hljs-attr">&quot;point&quot;</span>: <span class="hljs-string">&quot;æ€»æ¶ˆè€—ç§¯åˆ†æ•°é‡&quot;</span><br>&#125;<br></code></pre></td></tr></table></figure></li>
<li><p>å¿…é¡»ä½¿ç”¨POSTæ–¹æ³•.</p>
</li>
<li><p>ä½¿ç”¨è¯·æ±‚å¤´ä¸­çš„Cookieå­—æ®µä½œä¸ºç”¨æˆ·é‰´æƒ, ä¸€äº›éå¿…è¦å­—æ®µä¹Ÿå¯çœç•¥.</p>
</li>
</ol>
<p>å…‘æ¢æˆåŠŸå“åº”ä½“å†…å®¹ä¸º</p>
<figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs json">&#123;<br>  <span class="hljs-attr">&quot;code&quot;</span>: <span class="hljs-number">0</span>,<br>  <span class="hljs-attr">&quot;msg&quot;</span>: <span class="hljs-string">&quot;&quot;</span>,<br>  <span class="hljs-attr">&quot;data&quot;</span>: &#123;<br>    <span class="hljs-attr">&quot;id&quot;</span>: <span class="hljs-string">&quot;å•†å“ä½¿ç”¨ID&quot;</span>,<br>    <span class="hljs-attr">&quot;expire_day&quot;</span>: <span class="hljs-string">&quot;å•†å“è¿‡æœŸå‰©ä½™å¤©&quot;</span>,<br>    <span class="hljs-attr">&quot;remain_amount&quot;</span>: <span class="hljs-string">&quot;å•†å“åº“å­˜&quot;</span>,<br>    <span class="hljs-attr">&quot;deadline&quot;</span>: <span class="hljs-string">&quot;0001-01-01T00:00:00Z&quot;</span><br>  &#125;<br>&#125;<br></code></pre></td></tr></table></figure>

<h2 id="ç¬¬ä¸‰æ­¥-ç¼–å†™è„šæœ¬"><a href="#ç¬¬ä¸‰æ­¥-ç¼–å†™è„šæœ¬" class="headerlink" title="ç¬¬ä¸‰æ­¥: ç¼–å†™è„šæœ¬"></a>ç¬¬ä¸‰æ­¥: ç¼–å†™è„šæœ¬</h2><blockquote>
<p><strong>ä»€ä¹ˆæ˜¯å‡½æ•°</strong></p>
</blockquote>
<p>å‡½æ•°æ˜¯ JavaScript ä¸­çš„åŸºæœ¬ç»„ä»¶ä¹‹ä¸€, ä¸€ä¸ªå‡½æ•°æ˜¯ JavaScriptè¿‡ç¨‹ä¸­æ‰§è¡Œä¸€ç»„ä»»åŠ¡æˆ–è®¡ç®—å€¼çš„è¯­å¥.</p>
<p>æœ¬æ–‡çš„æŠ¢åˆ¸è„šæœ¬å°†å®šä¹‰å„ç§å‡½æ•°ä»¥æ–¹ä¾¿ç»Ÿä¸€è°ƒç”¨.</p>
<p>æŸ¥çœ‹ <a target="_blank" rel="noopener" href="https://developer.mozilla.org/zh-CN/docs/Web/JavaScript/Guide/Functions">JavaScript å‡½æ•°è¯¦ç»†å‚è€ƒæ–‡æ¡£</a> äº†è§£æ›´å¤š.</p>
<h3 id="åº”ç”¨å…¼å®¹"><a href="#åº”ç”¨å…¼å®¹" class="headerlink" title="åº”ç”¨å…¼å®¹"></a>åº”ç”¨å…¼å®¹</h3><p>ç”±äºè¯¥è„šæœ¬é’ˆå¯¹å¤šå¹³å°, è„šæœ¬çš„å†™æ³•éœ€è¦åŒæ—¶å…¼å®¹Surgeæˆ–QuanXä¹‹ç±»çš„å®¢æˆ·ç«¯, é‚£ä¹ˆæˆ‘ä»¬å°±éœ€è¦å†™ä¸€ä¸ªå…¼å®¹å‡½æ•°è®©å®ƒåœ¨ä¸åŒç¯å¢ƒä¸‹ä¹Ÿèƒ½è¢«æ­£ç¡®æ‰§è¡Œ.</p>
<p>ä»¥ä¸‹å‡½æ•°å…¼å®¹Surgeã€QXã€Loonä¸­çš„éƒ¨åˆ†API, åŒ…æ‹¬æŒä¹…åŒ–è¯»å–ã€é€šçŸ¥ã€POSTè¯·æ±‚</p>
<figure class="highlight javascript"><figcaption><span>å…¼å®¹å‡½æ•° (ç‚¹å‡»å·¦è¾¹ç®­å¤´å±•å¼€) >folded</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><br><span class="hljs-comment">// const $ = new nobyda(); </span><br><span class="hljs-comment">// å‘é€ä¸€ä¸ªé€šçŸ¥: $.notify(&#x27;title&#x27;, &#x27;subtitle&#x27;, &#x27;message&#x27;)</span><br><span class="hljs-comment">// æŒä¹…åŒ–è¯»å–: $.read(&#x27;Key&#x27;)</span><br><span class="hljs-comment">// POSTè¯·æ±‚: $.post(url&lt;Object&gt;,callback&lt;Function&gt;)</span><br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">nobyda</span>(<span class="hljs-params"></span>) </span>&#123;<br>	<span class="hljs-keyword">const</span> isSurge = <span class="hljs-keyword">typeof</span> $httpClient != <span class="hljs-string">&quot;undefined&quot;</span>;<br>	<span class="hljs-keyword">const</span> isQuanX = <span class="hljs-keyword">typeof</span> $task != <span class="hljs-string">&quot;undefined&quot;</span>;<br>	<span class="hljs-keyword">const</span> isNode = <span class="hljs-keyword">typeof</span> <span class="hljs-built_in">require</span> == <span class="hljs-string">&quot;function&quot;</span>;<br>	<span class="hljs-keyword">const</span> node = (<span class="hljs-function">() =&gt;</span> &#123;<br>		<span class="hljs-keyword">if</span> (isNode) &#123;<br>			<span class="hljs-keyword">const</span> request = <span class="hljs-built_in">require</span>(<span class="hljs-string">&#x27;request&#x27;</span>);<br>			<span class="hljs-keyword">return</span> &#123;<br>				request<br>			&#125;<br>		&#125; <span class="hljs-keyword">else</span> &#123;<br>			<span class="hljs-keyword">return</span> <span class="hljs-literal">null</span>;<br>		&#125;<br>	&#125;)()<br>	<span class="hljs-keyword">const</span> adapterStatus = <span class="hljs-function">(<span class="hljs-params">response</span>) =&gt;</span> &#123;<br>		<span class="hljs-keyword">if</span> (response) &#123;<br>			<span class="hljs-keyword">if</span> (response.status) &#123;<br>				response[<span class="hljs-string">&quot;statusCode&quot;</span>] = response.status<br>			&#125; <span class="hljs-keyword">else</span> <span class="hljs-keyword">if</span> (response.statusCode) &#123;<br>				response[<span class="hljs-string">&quot;status&quot;</span>] = response.statusCode<br>			&#125;<br>		&#125;<br>		<span class="hljs-keyword">return</span> response<br>	&#125;<br>	<span class="hljs-built_in">this</span>.read = <span class="hljs-function">(<span class="hljs-params">key</span>) =&gt;</span> &#123;<br>		<span class="hljs-keyword">if</span> (isQuanX) <span class="hljs-keyword">return</span> $prefs.valueForKey(key)<br>		<span class="hljs-keyword">if</span> (isSurge) <span class="hljs-keyword">return</span> $persistentStore.read(key)<br>	&#125;<br>	<span class="hljs-built_in">this</span>.notify = <span class="hljs-function">(<span class="hljs-params">title, subtitle, message</span>) =&gt;</span> &#123;<br>		<span class="hljs-keyword">if</span> (isQuanX) $notify(title, subtitle, message)<br>		<span class="hljs-keyword">if</span> (isSurge) $notification.post(title, subtitle, message)<br>		<span class="hljs-keyword">if</span> (isNode) <span class="hljs-built_in">console</span>.log(<span class="hljs-string">`<span class="hljs-subst">$&#123;title&#125;</span>\n<span class="hljs-subst">$&#123;subtitle&#125;</span>\n<span class="hljs-subst">$&#123;message&#125;</span>`</span>)<br>	&#125;<br>	<span class="hljs-built_in">this</span>.post = <span class="hljs-function">(<span class="hljs-params">options, callback</span>) =&gt;</span> &#123;<br>		options.headers[<span class="hljs-string">&#x27;User-Agent&#x27;</span>] = <span class="hljs-string">&#x27;User-Agent: Mozilla/5.0 (iPhone; CPU iPhone OS 13_6_1 like Mac OS X) AppleWebKit/609.3.5.0.2 (KHTML, like Gecko) Mobile/17G80 BiliApp/822 mobi_app/ios_comic channel/AppStore BiliComic/822&#x27;</span><br>		<span class="hljs-keyword">if</span> (isQuanX) &#123;<br>			<span class="hljs-keyword">if</span> (<span class="hljs-keyword">typeof</span> options == <span class="hljs-string">&quot;string&quot;</span>) options = &#123;<br>				<span class="hljs-attr">url</span>: options<br>			&#125;<br>			options[<span class="hljs-string">&quot;method&quot;</span>] = <span class="hljs-string">&quot;POST&quot;</span><br>			$task.fetch(options).then(<span class="hljs-function"><span class="hljs-params">response</span> =&gt;</span> &#123;<br>				callback(<span class="hljs-literal">null</span>, adapterStatus(response), response.body)<br>			&#125;, <span class="hljs-function"><span class="hljs-params">reason</span> =&gt;</span> callback(reason.error, <span class="hljs-literal">null</span>, <span class="hljs-literal">null</span>))<br>		&#125;<br>		<span class="hljs-keyword">if</span> (isSurge) &#123;<br>			options.headers[<span class="hljs-string">&#x27;X-Surge-Skip-Scripting&#x27;</span>] = <span class="hljs-literal">false</span><br>			$httpClient.post(options, <span class="hljs-function">(<span class="hljs-params">error, response, body</span>) =&gt;</span> &#123;<br>				callback(error, adapterStatus(response), body)<br>			&#125;)<br>		&#125;<br>		<span class="hljs-keyword">if</span> (isNode) &#123;<br>			node.request.post(options, <span class="hljs-function">(<span class="hljs-params">error, response, body</span>) =&gt;</span> &#123;<br>				callback(error, adapterStatus(response), body)<br>			&#125;)<br>		&#125;<br>	&#125;<br>	<span class="hljs-built_in">this</span>.done = <span class="hljs-function">() =&gt;</span> &#123;<br>		<span class="hljs-keyword">if</span> (isQuanX || isSurge) &#123;<br>			$done()<br>		&#125;<br>	&#125;<br>&#125;;<br><br></code></pre></td></tr></table></figure>



<h3 id="å…¨å±€å˜é‡"><a href="#å…¨å±€å˜é‡" class="headerlink" title="å…¨å±€å˜é‡"></a>å…¨å±€å˜é‡</h3><p>å†™å¥½å…¼å®¹å‡½æ•°åæˆ‘ä»¬å…ˆå®šä¹‰ä¸€äº›å…¨å±€å˜é‡, ä¾›æ‰€æœ‰å‡½æ•°è°ƒç”¨.</p>
<figure class="highlight javascript"><figcaption><span>å…¨å±€å˜é‡</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-comment">// æ–°å»ºä¸€ä¸ªå®ä¾‹å¯¹è±¡, æŠŠå…¼å®¹å‡½æ•°å®šä¹‰åˆ°$ä¸­, ä»¥ä¾¿ç»Ÿä¸€è°ƒç”¨</span><br><span class="hljs-keyword">let</span> $ = <span class="hljs-keyword">new</span> nobyda();<br><br><span class="hljs-comment">// è¯»å–å…‘æ¢å•†å“å, é»˜è®¤å…‘æ¢ç§¯åˆ†å•†åŸä¸­çš„&quot;ç§¯åˆ†å…‘æ¢&quot;; è¯¥æ¥å£ä¸ºBoxJsé¢„ç•™, ä»¥ä¾¿ä¿®æ”¹</span><br><span class="hljs-keyword">let</span> productName = $.read(<span class="hljs-string">&#x27;BM_ProductName&#x27;</span>) || <span class="hljs-string">&#x27;ç§¯åˆ†å…‘æ¢&#x27;</span>;<br><br><span class="hljs-comment">// è¯»å–å…‘æ¢æ•°é‡, é»˜è®¤å…‘æ¢æœ€å¤§å€¼; è¯¥æ¥å£ä¸ºBoxJsé¢„ç•™, ä»¥ä¾¿ä¿®æ”¹</span><br><span class="hljs-keyword">let</span> productNum = $.read(<span class="hljs-string">&#x27;BM_ProductNum&#x27;</span>);<br><br><span class="hljs-comment">// è¯»å–å¾ªç¯æŠ¢è´­æ¬¡æ•°, é»˜è®¤100æ¬¡; è¯¥æ¥å£ä¸ºBoxJsé¢„ç•™, ä»¥ä¾¿ä¿®æ”¹</span><br><span class="hljs-keyword">let</span> exchangeNum = $.read(<span class="hljs-string">&#x27;BM_ExchangeNum&#x27;</span>) || <span class="hljs-string">&#x27;100&#x27;</span>;<br><br><span class="hljs-comment">// è¯»å–å“”å“©å“”å“©æ¼«ç”»ç­¾åˆ°è„šæœ¬æ‰€ä½¿ç”¨çš„Cookie</span><br><span class="hljs-keyword">let</span> cookie = $.read(<span class="hljs-string">&#x27;CookieBM&#x27;</span>);<br><br><span class="hljs-comment">// é¢„ç•™çš„ç©ºå¯¹è±¡, ä¾¿äºå‡½æ•°ä¹‹é—´è¯»å–æ•°æ®</span><br><span class="hljs-keyword">let</span> user = &#123;&#125;;<br></code></pre></td></tr></table></figure>



<h3 id="æŸ¥è¯¢ç§¯åˆ†"><a href="#æŸ¥è¯¢ç§¯åˆ†" class="headerlink" title="æŸ¥è¯¢ç§¯åˆ†"></a>æŸ¥è¯¢ç§¯åˆ†</h3><p>è„šæœ¬å¼€å§‹æ—¶é¦–å…ˆè¦åšçš„æ˜¯æŸ¥è¯¢è´¦å·é‡Œçš„ç§¯åˆ†æ˜¯å¦ç¬¦åˆå…‘æ¢è¦æ±‚.</p>
<p>è¯¥å‡½æ•°è°ƒç”¨æ—¶, å°†æ‰§è¡ŒæŸ¥è¯¢ç§¯åˆ†, å¦‚æœæŸ¥è¯¢ç”¨æˆ·ç§¯åˆ†æˆåŠŸ, åˆ™å°†æŸ¥è¯¢åˆ°çš„ç§¯åˆ†èµ‹å€¼åˆ°<a href="#%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F">å…¨å±€å˜é‡</a>ä¸­, ä¾›å…¶ä»–å‡½æ•°è¯»å–.</p>
<figure class="highlight javascript"><figcaption><span>æŸ¥è¯¢ç§¯åˆ†å‡½æ•°</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">GetUserPoint</span>(<span class="hljs-params"></span>) </span>&#123;<br>	<span class="hljs-keyword">const</span> pointUrl = &#123; <span class="hljs-comment">//æŸ¥è¯¢ç§¯åˆ†æ¥å£</span><br>		<span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;https://manga.bilibili.com/twirp/pointshop.v1.Pointshop/GetUserPoint&#x27;</span>,<br>		<span class="hljs-attr">headers</span>: &#123; <span class="hljs-comment">//è¯·æ±‚å¤´</span><br>			<span class="hljs-string">&#x27;Cookie&#x27;</span>: cookie <span class="hljs-comment">//ç”¨æˆ·é‰´æƒCookie</span><br>		&#125;<br>	&#125;<br>	<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123; <span class="hljs-comment">//ä¸»å‡½æ•°è¿”å›Promiseå®ä¾‹å¯¹è±¡, ä»¥ä¾¿åç»­è°ƒç”¨æ—¶å¯ä»¥å®ç°é¡ºåºæ‰§è¡Œå¼‚æ­¥å‡½æ•°</span><br>		$.post(pointUrl, <span class="hljs-function">(<span class="hljs-params">error, resp, data</span>) =&gt;</span> &#123; <span class="hljs-comment">//ä½¿ç”¨postè¯·æ±‚æŸ¥è¯¢, å†ä½¿ç”¨å›è°ƒå‡½æ•°å¤„ç†è¿”å›çš„ç»“æœ</span><br>			<span class="hljs-keyword">try</span> &#123; <span class="hljs-comment">//ä½¿ç”¨tryæ–¹æ³•æ•è·å¯èƒ½å‡ºç°çš„ä»£ç å¼‚å¸¸</span><br>				<span class="hljs-keyword">if</span> (error) &#123;<br>					<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(error); <span class="hljs-comment">//å¦‚æœè¯·æ±‚å¤±è´¥, ä¾‹å¦‚æ— æ³•è”ç½‘, åˆ™æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸</span><br>				&#125; <span class="hljs-keyword">else</span> &#123;<br>					<span class="hljs-keyword">const</span> body = <span class="hljs-built_in">JSON</span>.parse(data); <span class="hljs-comment">//è§£æå“åº”ä½“jsonå¹¶è½¬åŒ–ä¸ºå¯¹è±¡</span><br>					<span class="hljs-keyword">if</span> (body.code == <span class="hljs-number">0</span> &amp;&amp; body.data) &#123; <span class="hljs-comment">//å¦‚æœå“åº”ä½“ä¸ºé¢„æœŸæ ¼å¼</span><br>						user.point = <span class="hljs-built_in">parseInt</span>(body.data.point); <span class="hljs-comment">//æŠŠæŸ¥è¯¢çš„ç§¯åˆ†èµ‹å€¼åˆ°å…¨å±€å˜é‡userä¸­</span><br>						<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`\nå½“å‰ç§¯åˆ†: <span class="hljs-subst">$&#123;body.data.point&#125;</span>`</span>); <span class="hljs-comment">//æ‰“å°æ—¥å¿—</span><br>					&#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">//å¦åˆ™æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸</span><br>						<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(body.msg || data);<br>					&#125;<br>				&#125;<br>			&#125; <span class="hljs-keyword">catch</span> (e) &#123; <span class="hljs-comment">//æ¥ä½tryä»£ç å—ä¸­æŠ›å‡ºçš„å¼‚å¸¸, å¹¶æ‰“å°æ—¥å¿—</span><br>				<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`\næŸ¥è¯¢ç§¯åˆ†: å¤±è´¥\nå‡ºç°é”™è¯¯: <span class="hljs-subst">$&#123;e.message&#125;</span>`</span>);<br>			&#125; <span class="hljs-keyword">finally</span> &#123; <span class="hljs-comment">//finallyè¯­å¥åœ¨tryå’Œcatchä¹‹åæ— è®ºæœ‰æ— å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œ</span><br>				resolve(); <span class="hljs-comment">//å¼‚æ­¥æ“ä½œæˆåŠŸæ—¶è°ƒç”¨, å°†Promiseå¯¹è±¡çš„çŠ¶æ€æ ‡è®°ä¸º&quot;æˆåŠŸ&quot;, è¡¨ç¤ºå·²å®ŒæˆæŸ¥è¯¢ç§¯åˆ†</span><br>			&#125;<br>		&#125;)<br>	&#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="æŸ¥è¯¢å•†å“"><a href="#æŸ¥è¯¢å•†å“" class="headerlink" title="æŸ¥è¯¢å•†å“"></a>æŸ¥è¯¢å•†å“</h3><p>æ ¹æ®å‰é¢çš„åˆ†æ, æˆ‘ä»¬å…‘æ¢å•†å“æ—¶éœ€è¦ç›¸åº”çš„å•†å“ID.</p>
<p>è¯¥å‡½æ•°è°ƒç”¨æ—¶, å°†æ‰§è¡ŒæŸ¥è¯¢æ“ä½œ, å¹¶æ ¹æ®<a href="#%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F">å…¨å±€å˜é‡</a>æ‰€å®šä¹‰çš„å•†å“åè¿›è¡Œè¿‡æ»¤, è¿‡æ»¤åçš„å†…å®¹ä»…åŒ…å«ç›¸å…³å•†å“çš„åŸºæœ¬ä¿¡æ¯, ä¾‹å¦‚å•†å“IDã€å…‘æ¢ä»·æ ¼ã€åº“å­˜ç­‰, å†æŠŠè¿‡æ»¤åçš„å†…å®¹èµ‹å€¼åˆ°<a href="#%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F">å…¨å±€å˜é‡</a>ä¸­, ä¾›å…¶ä»–å‡½æ•°è¯»å–.</p>
<figure class="highlight javascript"><figcaption><span>æŸ¥è¯¢å•†å“å‡½æ•°</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ListProduct</span>(<span class="hljs-params"></span>) </span>&#123;<br>	<span class="hljs-keyword">const</span> listUrl = &#123; <span class="hljs-comment">//æŸ¥è¯¢å•†å“æ¥å£</span><br>		<span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;https://manga.bilibili.com/twirp/pointshop.v1.Pointshop/ListProduct&#x27;</span>,<br>		<span class="hljs-attr">headers</span>: &#123;&#125;<br>	&#125;<br>	<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123; <span class="hljs-comment">//ä¸»å‡½æ•°è¿”å›Promiseå®ä¾‹å¯¹è±¡, ä»¥ä¾¿åç»­è°ƒç”¨æ—¶å¯ä»¥å®ç°é¡ºåºæ‰§è¡Œå¼‚æ­¥å‡½æ•°</span><br>		$.post(listUrl, <span class="hljs-function">(<span class="hljs-params">error, resp, data</span>) =&gt;</span> &#123; <span class="hljs-comment">//ä½¿ç”¨postè¯·æ±‚æŸ¥è¯¢, å†ä½¿ç”¨å›è°ƒå‡½æ•°å¤„ç†è¿”å›çš„ç»“æœ</span><br>			<span class="hljs-keyword">try</span> &#123; <span class="hljs-comment">//ä½¿ç”¨tryæ–¹æ³•æ•è·å¯èƒ½å‡ºç°çš„ä»£ç å¼‚å¸¸</span><br>				<span class="hljs-keyword">if</span> (error) &#123;<br>					<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(error); <span class="hljs-comment">//å¦‚æœè¯·æ±‚å¤±è´¥, ä¾‹å¦‚æ— æ³•è”ç½‘, åˆ™æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸</span><br>				&#125; <span class="hljs-keyword">else</span> &#123;<br>					<span class="hljs-keyword">const</span> body = <span class="hljs-built_in">JSON</span>.parse(data); <span class="hljs-comment">//è§£æå“åº”ä½“jsonå¹¶è½¬åŒ–ä¸ºå¯¹è±¡</span><br>					<span class="hljs-keyword">if</span> (body.code == <span class="hljs-number">0</span> &amp;&amp; body.data.length &gt;= <span class="hljs-number">1</span>) &#123; <span class="hljs-comment">//å¦‚æœæ¥å£æ­£å¸¸è¿”å›å•†å“ä¿¡æ¯</span><br>						<span class="hljs-comment">// æŒ‰å…¨å±€å˜é‡æ‰€å¡«å†™çš„å•†å“åè¿›è¡Œè¿‡æ»¤, å¹¶æŠŠå•†å“ä¿¡æ¯èµ‹å€¼åˆ°å…¨å±€å˜é‡userä¸­</span><br>						user.list = body.data.filter(<span class="hljs-function"><span class="hljs-params">t</span> =&gt;</span> t.title == productName).pop();<br>						<span class="hljs-keyword">if</span> (!user.list) &#123;<br>							<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&#x27;è¯·æ£€æŸ¥å•†å“å&#x27;</span>); <span class="hljs-comment">//å¦‚æœå¡«é”™å•†å“ååˆ™æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸</span><br>						&#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">//å¦åˆ™æ‰“å°æ—¥å¿—</span><br>							<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`\næŸ¥è¯¢å•†å“: <span class="hljs-subst">$&#123;productName&#125;</span>\nå•†å“åº“å­˜: <span class="hljs-subst">$&#123;user.list.remain_amount&#125;</span>`</span>)<br>						&#125;<br>					&#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">//å¦åˆ™æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸</span><br>						<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(<span class="hljs-string">&#x27;æ— å•†å“åˆ—è¡¨&#x27;</span>);<br>					&#125;<br>				&#125;<br>			&#125; <span class="hljs-keyword">catch</span> (e) &#123; <span class="hljs-comment">//æ¥ä½tryä»£ç å—ä¸­æŠ›å‡ºçš„å¼‚å¸¸å¹¶æ‰“å°æ—¥å¿—</span><br>				<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`\næŸ¥è¯¢å•†å“: <span class="hljs-subst">$&#123;productName&#125;</span>\nå‡ºç°é”™è¯¯: <span class="hljs-subst">$&#123;e.message&#125;</span>`</span>);<br>			&#125; <span class="hljs-keyword">finally</span> &#123; <span class="hljs-comment">//finallyè¯­å¥åœ¨tryå’Œcatchä¹‹åæ— è®ºæœ‰æ— å¼‚å¸¸éƒ½ä¼šæ‰§è¡Œ</span><br>				resolve(); <span class="hljs-comment">//å¼‚æ­¥æ“ä½œæˆåŠŸæ—¶è°ƒç”¨, å°†Promiseå¯¹è±¡çš„çŠ¶æ€æ ‡è®°ä¸º&quot;æˆåŠŸ&quot;, è¡¨ç¤ºå·²å®ŒæˆæŸ¥è¯¢å•†å“</span><br>			&#125;<br>		&#125;)<br>	&#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="å…‘æ¢å•†å“"><a href="#å…‘æ¢å•†å“" class="headerlink" title="å…‘æ¢å•†å“"></a>å…‘æ¢å•†å“</h3><p>å…‘æ¢å•†å“åˆ†ä¸ºä¸¤ä¸ªå‡½æ•°, ç¬¬ä¸€ä¸ªå‡½æ•°è°ƒç”¨å, å°†æ ¹æ®å‰é¢æŸ¥è¯¢åˆ°çš„æ•°æ®è¿›è¡Œåˆ¤æ–­, å¦‚æœå•†å“æœ‰åº“å­˜å¹¶ä¸”ç”¨æˆ·ç§¯åˆ†å¤§äº100, åˆ™æ ¹æ®<a href="#%E5%85%A8%E5%B1%80%E5%8F%98%E9%87%8F">å…¨å±€å˜é‡</a>æ‰€å®šä¹‰çš„å¾ªç¯æ¬¡æ•°, æš´åŠ›è°ƒç”¨ç¬¬äºŒä¸ªâ€è¯·æ±‚â€å‡½æ•° (é»˜è®¤å¾ªç¯100æ¬¡)</p>
<figure class="highlight javascript"><figcaption><span>å…‘æ¢å•†å“å‡½æ•°</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br></pre></td><td class="code"><pre><code class="hljs javascript"><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">ExchangeProduct</span>(<span class="hljs-params"></span>) </span>&#123;<br>	<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-keyword">async</span> (resolve) =&gt; &#123; <span class="hljs-comment">//ä¸»å‡½æ•°è¿”å›Promiseå®ä¾‹å¯¹è±¡, ä»¥ä¾¿åç»­è°ƒç”¨æ—¶å¯ä»¥å®ç°é¡ºåºæ‰§è¡Œå¼‚æ­¥å‡½æ•°, è¯¥å®ä¾‹å‡½æ•°å¸¦æœ‰asyncå…³é”®å­—, è¡¨ç¤ºé‡Œé¢æœ‰å¼‚æ­¥æ“ä½œ, ä¾‹å¦‚å¯ä½¿ç”¨awaitå¾—åˆ°å¼‚æ­¥ç»“æœ</span><br>		<span class="hljs-keyword">if</span> (user.list &amp;&amp; user.list.remain_amount &amp;&amp; user.point &gt;= <span class="hljs-number">100</span>) &#123; <span class="hljs-comment">//å¦‚æœå•†å“æœ‰åº“å­˜å¹¶ä¸”ç”¨æˆ·ç§¯åˆ†å¤§äº100åˆ™è¿›è¡ŒæŠ¢è´­</span><br>			<span class="hljs-comment">//å…‘æ¢å•†å“æ•°é‡(ç”¨æˆ·ç§¯åˆ† é™¤ä¸ å•†å“å•ä»·å¾—åˆ°å…‘æ¢æ•°é‡), å¹¶è½¬æˆæ•´æ•°; é»˜è®¤å…‘æ¢æœ€å¤§æ•°é‡</span><br>			<span class="hljs-keyword">const</span> num = <span class="hljs-built_in">parseInt</span>(productNum || (user.point / user.list.real_cost));<br>			<span class="hljs-keyword">const</span> exchangeUrl = &#123;<br>				<span class="hljs-attr">url</span>: <span class="hljs-string">&#x27;https://manga.bilibili.com/twirp/pointshop.v1.Pointshop/Exchange&#x27;</span>, <span class="hljs-comment">//å…‘æ¢å•†å“æ¥å£</span><br>				<span class="hljs-attr">headers</span>: &#123; <span class="hljs-comment">//è¯·æ±‚å¤´</span><br>					<span class="hljs-string">&#x27;Content-Type&#x27;</span>: <span class="hljs-string">&#x27;application/json&#x27;</span>, <span class="hljs-comment">//å£°æ˜è¯·æ±‚ä½“æ•°æ®æ ¼å¼</span><br>					<span class="hljs-string">&#x27;Cookie&#x27;</span>: cookie <span class="hljs-comment">//ç”¨æˆ·é‰´æƒCookie</span><br>				&#125;,<br>				<span class="hljs-attr">body</span>: <span class="hljs-built_in">JSON</span>.stringify(&#123; <span class="hljs-comment">//è¯·æ±‚ä½“è½¬æˆå­—ç¬¦ä¸²ç±»å‹</span><br>					<span class="hljs-attr">product_id</span>: user.list.id, <span class="hljs-comment">//å…‘æ¢çš„å•†å“id</span><br>					<span class="hljs-attr">product_num</span>: num, <span class="hljs-comment">//å…‘æ¢çš„å•†å“æ•°é‡</span><br>					<span class="hljs-attr">point</span>: num * user.list.real_cost <span class="hljs-comment">//æ¶ˆè€—çš„ç§¯åˆ†æ€»æ•° (å…‘æ¢æ•°é‡ä¹˜å•ä»·å¾—åˆ°ç§¯åˆ†æ€»æ•°)</span><br>				&#125;)<br>			&#125;;<br>			<span class="hljs-keyword">for</span> (<span class="hljs-keyword">let</span> i = <span class="hljs-number">0</span>; i &lt; <span class="hljs-built_in">parseInt</span>(exchangeNum); i++) &#123; <span class="hljs-comment">//æ ¹æ®å…¨å±€å˜é‡å®šä¹‰çš„æ¬¡æ•°, æš´åŠ›å¾ªç¯æŠ¢è´­</span><br>				<span class="hljs-comment">// å¾ªç¯å†…è°ƒç”¨å¦ä¸€ä¸ªæŠ¢è´­å‡½æ•°, å¹¶ä¼ å…¥è¯·æ±‚ã€ç¬¬å‡ æ¬¡å¾ªç¯ã€å…‘æ¢æ•°é‡ç­‰å‚æ•°, </span><br>				<span class="hljs-comment">// ä½¿ç”¨awaitå…³é”®å­—å£°æ˜, è¡¨ç¤ºéœ€è¦ç­‰å¾…æ¯ä¸€æ¬¡çš„æ‰§è¡Œç»“æœ</span><br>				<span class="hljs-keyword">const</span> run = <span class="hljs-keyword">await</span> startExchange(exchangeUrl, i, num);<br>				<span class="hljs-keyword">if</span> (run) &#123;<br>					<span class="hljs-keyword">break</span>; <span class="hljs-comment">//å¦‚æœå‡½æ•°è¿”å›å¸ƒå°”å€¼true, åˆ™è·³å‡ºå¾ªç¯, è„šæœ¬ç»“æŸ</span><br>				&#125;<br>			&#125;<br>		&#125; <span class="hljs-keyword">else</span> &#123; <span class="hljs-comment">//å•†å“æ— åº“å­˜æˆ–ç”¨æˆ·ç§¯åˆ†å°äº100ç­‰æƒ…å†µ, åˆ™ä¸æ‰§è¡ŒæŠ¢è´­, è„šæœ¬ç»“æŸ</span><br>			<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`\næŠ¢è´­ç»ˆæ­¢: ä¸å…·å¤‡å…‘æ¢æ¡ä»¶`</span>); <span class="hljs-comment">//æ‰“å°æ—¥å¿—</span><br>		&#125;<br>		resolve(); <span class="hljs-comment">//å°†ä¸»å‡½æ•°çš„Promiseå¯¹è±¡çŠ¶æ€æ ‡è®°ä¸º&quot;æˆåŠŸ&quot;, è¡¨ç¤ºå·²å®ŒæˆæŠ¢è´­ä»»åŠ¡</span><br>	&#125;)<br>&#125;<br><br><span class="hljs-function"><span class="hljs-keyword">function</span> <span class="hljs-title">startExchange</span>(<span class="hljs-params">url, item, amount</span>) </span>&#123;<br>	<span class="hljs-keyword">return</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Promise</span>(<span class="hljs-function">(<span class="hljs-params">resolve</span>) =&gt;</span> &#123; <span class="hljs-comment">//ä¸»å‡½æ•°è¿”å›Promiseå®ä¾‹å¯¹è±¡, ä»¥ä¾¿åç»­è°ƒç”¨æ—¶å¯ä»¥å®ç°é¡ºåºæ‰§è¡Œå¼‚æ­¥å‡½æ•°</span><br>		$.post(url, <span class="hljs-function">(<span class="hljs-params">error, resp, data</span>) =&gt;</span> &#123; <span class="hljs-comment">//ä½¿ç”¨postè¯·æ±‚æŸ¥è¯¢, å†ä½¿ç”¨å›è°ƒå‡½æ•°å¤„ç†è¿”å›çš„ç»“æœ</span><br>			<span class="hljs-keyword">try</span> &#123; <span class="hljs-comment">//ä½¿ç”¨tryæ–¹æ³•æ•è·å¯èƒ½å‡ºç°çš„ä»£ç å¼‚å¸¸</span><br>				<span class="hljs-keyword">if</span> (error) &#123;<br>					<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(error); <span class="hljs-comment">//å¦‚æœè¯·æ±‚å¤±è´¥, ä¾‹å¦‚æ— æ³•è”ç½‘, åˆ™æŠ›å‡ºä¸€ä¸ªå¼‚å¸¸</span><br>				&#125; <span class="hljs-keyword">else</span> &#123;<br>					<span class="hljs-keyword">const</span> body = <span class="hljs-built_in">JSON</span>.parse(data); <span class="hljs-comment">//è§£æå“åº”ä½“jsonå¹¶è½¬åŒ–ä¸ºå¯¹è±¡</span><br>					<span class="hljs-keyword">if</span> (body.code == <span class="hljs-number">0</span>) &#123; <span class="hljs-comment">//å¦‚æœæŠ¢è´­æˆåŠŸ, åˆ™è¾“å‡ºæ—¥å¿—å’Œé€šçŸ¥</span><br>						<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`\næŠ¢è´­æˆåŠŸ: ç¬¬<span class="hljs-subst">$&#123;item+<span class="hljs-number">1</span>&#125;</span>æ¬¡\næŠ¢è´­æ•°é‡: <span class="hljs-subst">$&#123;amount&#125;</span>\næ¶ˆè€—ç§¯åˆ†: <span class="hljs-subst">$&#123;amount * user.list.real_cost&#125;</span>`</span>);<br>						$.notify(<span class="hljs-string">&#x27;å“”å“©å“”å“©æ¼«ç”»æŠ¢åˆ¸&#x27;</span>, <span class="hljs-string">&#x27;&#x27;</span>, <span class="hljs-string">`&quot;<span class="hljs-subst">$&#123;productName&#125;</span>&quot;æŠ¢è´­æˆåŠŸ, æ•°é‡: <span class="hljs-subst">$&#123;amount&#125;</span>, æ¶ˆè€—ç§¯åˆ†: <span class="hljs-subst">$&#123;amount * user.list.real_cost&#125;</span>`</span>);<br>						resolve(<span class="hljs-literal">true</span>); <span class="hljs-comment">//å°†Promiseå¯¹è±¡çš„çŠ¶æ€æ ‡è®°ä¸º&quot;æˆåŠŸ&quot;, ç„¶åè¿”å›ä¸€ä¸ªå¸ƒå°”å€¼trueç”¨äºè·³å‡ºå¾ªç¯</span><br>					&#125; <span class="hljs-keyword">else</span> &#123;<br>						<span class="hljs-keyword">throw</span> <span class="hljs-keyword">new</span> <span class="hljs-built_in">Error</span>(body.msg || <span class="hljs-string">&#x27;æœªçŸ¥&#x27;</span>); <span class="hljs-comment">//æŠ¢è´­å¤±è´¥åˆ™æŠ›å‡ºå¼‚å¸¸</span><br>					&#125;<br>				&#125;<br>			&#125; <span class="hljs-keyword">catch</span> (e) &#123; <span class="hljs-comment">//æ¥ä½tryä»£ç å—ä¸­æŠ›å‡ºçš„å¼‚å¸¸å¹¶æ‰“å°æ—¥å¿—</span><br>				<span class="hljs-built_in">console</span>.log(<span class="hljs-string">`\næŠ¢è´­å¤±è´¥: ç¬¬<span class="hljs-subst">$&#123;item+<span class="hljs-number">1</span>&#125;</span>æ¬¡\nå¤±è´¥åŸå› : <span class="hljs-subst">$&#123;e.message&#125;</span>`</span>);<br>				resolve(); <span class="hljs-comment">//å°†Promiseå¯¹è±¡çš„çŠ¶æ€æ ‡è®°ä¸º&quot;æˆåŠŸ&quot;, ä½†ä¸è¿”å›ä»»ä½•å€¼, è¡¨ç¤ºç»§ç»­å¾ªç¯æŠ¢è´­</span><br>			&#125;<br>		&#125;)<br>	&#125;)<br>&#125;<br></code></pre></td></tr></table></figure>

<h3 id="ç»Ÿä¸€è°ƒç”¨"><a href="#ç»Ÿä¸€è°ƒç”¨" class="headerlink" title="ç»Ÿä¸€è°ƒç”¨"></a>ç»Ÿä¸€è°ƒç”¨</h3><p>å†™å¥½å‡½æ•°å, å¦‚æœä¸è¿›è¡Œè°ƒç”¨, é‚£ä¹ˆä»£ç æ˜¯æ— æ³•è¢«è¿è¡Œçš„.</p>
<p>åœ¨javascriptä¸­, ä»£ç çš„æ‰§è¡Œé¡ºåºå¾ˆé‡è¦, æˆ‘ä»¬çš„éœ€æ±‚æ˜¯å…ˆåŒæ—¶æŸ¥è¯¢ç§¯åˆ†å’Œå•†å“, å†æŠ¢è´­, æœ€åé€€å‡ºè„šæœ¬.</p>
<p>ä»¥ä¸‹åŒ¿åå‡½æ•°å°†æŒ‰æˆ‘ä»¬é¢„æœŸçš„é¡ºåºæ‰§è¡Œ.</p>
<figure class="highlight javascript"><figcaption><span>åŒ¿åå¼‚æ­¥å‡½æ•°</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br></pre></td><td class="code"><pre><code class="hljs javascript">(<span class="hljs-keyword">async</span> <span class="hljs-function"><span class="hljs-keyword">function</span>(<span class="hljs-params"></span>) </span>&#123; <span class="hljs-comment">// ç«‹å³è¿è¡Œçš„åŒ¿åå¼‚æ­¥å‡½æ•°</span><br>	<span class="hljs-comment">// ä½¿ç”¨awaitå…³é”®å­—å£°æ˜, è¡¨ç¤ºä»¥åŒæ­¥æ–¹å¼æ‰§è¡Œå¼‚æ­¥å‡½æ•°, å¯ä»¥ç®€å•ç†è§£ä¸ºé¡ºåºæ‰§è¡Œ</span><br>	<span class="hljs-keyword">await</span> <span class="hljs-built_in">Promise</span>.all([ <span class="hljs-comment">//è¯¥æ–¹æ³•ç”¨äºå°†å¤šä¸ªå®ä¾‹åŒ…è£…æˆä¸€ä¸ªæ–°çš„å®ä¾‹, å¯ä»¥ç®€å•ç†è§£ä¸ºåŒæ—¶è°ƒç”¨å‡½æ•°, ä»¥è¿›ä¸€æ­¥æé«˜æ‰§è¡Œé€Ÿåº¦</span><br>		GetUserPoint(), <span class="hljs-comment">//æŸ¥è¯¢ç§¯åˆ†å‡½æ•°</span><br>		ListProduct() <span class="hljs-comment">//æŸ¥è¯¢å•†å“å‡½æ•°</span><br>	]);<br>	<span class="hljs-keyword">await</span> ExchangeProduct(); <span class="hljs-comment">//ä¸Šé¢çš„æŸ¥è¯¢éƒ½å®Œæˆå, åˆ™æ‰§è¡ŒæŠ¢è´­</span><br>	$.done(); <span class="hljs-comment">//æŠ¢è´­å®Œæˆåè°ƒç”¨Surgeã€QXå†…éƒ¨ç‰¹æœ‰çš„å‡½æ•°, ç”¨äºé€€å‡ºè„šæœ¬æ‰§è¡Œ</span><br>&#125;)();<br></code></pre></td></tr></table></figure>

<h2 id="ç¬¬å››æ­¥-é…ç½®ä»»åŠ¡"><a href="#ç¬¬å››æ­¥-é…ç½®ä»»åŠ¡" class="headerlink" title="ç¬¬å››æ­¥: é…ç½®ä»»åŠ¡"></a>ç¬¬å››æ­¥: é…ç½®ä»»åŠ¡</h2><p>æˆ‘ä»¬å†™å¥½è„šæœ¬å, å°±å¯ä»¥åœ¨Surgeæˆ–QuantumultXé‡Œé…ç½®å®šæ—¶ä»»åŠ¡è®©å®ƒåœ¨è§„å®šæ—¶é—´å†…æ‰§è¡Œè¯¥è„šæœ¬.</p>
<p>ä»¥ä¸‹å°†ç”¨Surgeè¿›è¡Œæ¼”ç¤º</p>
<blockquote>
<p><strong>ç¼–è¾‘Surgeé…ç½®æ–‡ä»¶, åœ¨[Script]æ®µè½æ”¾å…¥ä»¥ä¸‹è„šæœ¬</strong></p>
</blockquote>
<figure class="highlight plaintext"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs plaintext">å“”å“©å“”å“©æ¼«ç”»æŠ¢åˆ¸ = type=cron,cronexp=&quot;10,20,30 0 12 * * *&quot;,wake-system=1,timeout=60,script-path=https://raw.githubusercontent.com/NobyDa/Script/master/Bilibili-DailyBonus/ExchangePoints.js<br></code></pre></td></tr></table></figure>

<p>å› ä¸ºç§¯åˆ†å•†åŸåˆ·æ–°æ—¶é—´åœ¨æ¯å¤©ä¸­åˆ12ç‚¹, åˆ™ä»¥ä¸Šé…ç½®å°†åœ¨æ¯å¤©ä¸­åˆ12:00:10ã€12:00:20ã€12:00:30åˆ†åˆ«æ‰§è¡Œä¸€æ¬¡.</p>
<p>æœ‰å‡ ç‚¹éœ€è¦æ³¨æ„</p>
<ol>
<li><p>è„šæœ¬æŠ¢è´­å®Œæˆåæ³¨æ„ç¦ç”¨, é¿å…æ¯å¤©æ— æ„ä¹‰çš„è¿è¡Œ</p>
</li>
<li><p>è„šæœ¬éœ€è¦ä½¿ç”¨<a target="_blank" rel="noopener" href="https://github.com/NobyDa/Script/blob/master/Bilibili-DailyBonus/Manga.js">å“”å“©å“”å“©ç­¾åˆ°è„šæœ¬</a>è·å–Cookieåæ–¹å¯ä½¿ç”¨.</p>
</li>
<li><p>é»˜è®¤å…‘æ¢ç§¯åˆ†å•†åŸä¸­çš„ â€œç§¯åˆ†å…‘æ¢â€; å¯è‡ªè¡Œä¿®æ”¹.</p>
</li>
<li><p>å…‘æ¢æ•°é‡ä¸ºç”¨æˆ·ç§¯åˆ†å¯å…‘æ¢çš„æœ€å¤§å€¼; å¯è‡ªè¡Œä¿®æ”¹.</p>
</li>
</ol>
<h1 id="ç»“è¯­"><a href="#ç»“è¯­" class="headerlink" title="ç»“è¯­"></a>ç»“è¯­</h1><p>æœ¬æ–‡åˆæ˜¯ä¸€ç¯‡ä¸“ä¸šæ€§æå¼ºçš„æ–‡ç« , æœ‰çš„åŒå­¦å¯èƒ½åˆè¦å¤´å¤§äº†; å†™è¿™ç¯‡æ–‡ç« åŠ¨æœºä¸»è¦æ˜¯ä¸ºäº†è®©è¯»è€…äº†è§£ä¸€ä¸ªéœ€æ±‚çš„å®ç°è¿‡ç¨‹, è„šæœ¬é‡Œä¹Ÿæœ‰å¤§é‡æ³¨é‡Šä¾›è¯»è€…ç†è§£æ€è·¯.</p>
<p>è¿™ä¸ªéœ€æ±‚è¯´éš¾ä¹Ÿä¸å¤ªéš¾, å°±æ˜¯æŠ“å‡ ä¸ªæ¥å£å»æ¨¡æ‹Ÿç”¨æˆ·å…‘æ¢çš„è¡Œä¸º. å½“ç„¶è¿˜æ˜¯éœ€è¦æœ‰ä¸€å®šçš„æŠ“åŒ…ç»éªŒå’ŒjavascriptåŠŸåº•æ‰è¡Œ; æˆ‘çš„javascriptåŠŸåº•ä¹Ÿå°±å‹‰å‹‰å¼ºå¼ºå¤Ÿæˆ‘å†™å‡ ä¸ªç®€å•éœ€æ±‚.</p>
<p>è™½ç„¶æœ¬æ–‡çœ‹èµ·æ¥æ¯”è¾ƒæ°´, ä½†è¿˜æ˜¯å»ºè®®åˆå­¦è€…ç…§ç€æœ¬æ–‡å»ç†è§£æŠ“åŒ…æ€è·¯, ä»¥åŠè„šæœ¬çš„æ‰§è¡Œé€»è¾‘.</p>
<p>æœ€å, æå‰ç¥å¤§å®¶å‘¨æœ«æ„‰å¿«!</p>
</div><div class="article-licensing box"><div class="licensing-title"><p>è®°å½•ä¸€æ¬¡Surge &amp; QuantumultX è„šæœ¬å¼€å‘è¿‡ç¨‹</p><p><a href="https://nobyda.github.io/2021/07/16/BilibiliManga_Js_example/">https://nobyda.github.io/2021/07/16/BilibiliManga_Js_example/</a></p></div><div class="licensing-meta level is-mobile"><div class="level-left"><div class="level-item is-narrow"><div><h6>ä½œè€…</h6><p>NobyDa</p></div></div><div class="level-item is-narrow"><div><h6>å‘å¸ƒäº</h6><p>2021-07-16</p></div></div><div class="level-item is-narrow"><div><h6>æ›´æ–°äº</h6><p>2021-07-17</p></div></div><div class="level-item is-narrow"><div><h6>è®¸å¯åè®®</h6><p><a class="icons" rel="noopener" target="_blank" title="Creative Commons" href="https://creativecommons.org/"><i class="icon fab fa-creative-commons"></i></a><a class="icons" rel="noopener" target="_blank" title="Attribution" href="https://creativecommons.org/licenses/by/4.0/"><i class="icon fab fa-creative-commons-by"></i></a><a class="icons" rel="noopener" target="_blank" title="Noncommercial" href="https://creativecommons.org/licenses/by-nc/4.0/"><i class="icon fab fa-creative-commons-nc"></i></a></p></div></div></div></div></div><div class="article-tags is-size-7 mb-4"><span class="mr-2">#</span><a class="link-muted mr-2" rel="tag" href="/tags/Surge/">Surge</a><a class="link-muted mr-2" rel="tag" href="/tags/QuantumultX/">QuantumultX</a><a class="link-muted mr-2" rel="tag" href="/tags/JavaScript/">JavaScript</a></div><div class="sharethis-inline-share-buttons"></div><script src="https://platform-api.sharethis.com/js/sharethis.js#property=60bb78906cfa7d00118e7e9e&amp;product=inline-share-buttons" defer></script></article></div><div class="card"><div class="card-content"><h3 class="menu-label has-text-centered">å–œæ¬¢è¿™ç¯‡æ–‡ç« ï¼Ÿæ‰“èµä¸€ä¸‹ä½œè€…å§</h3><div class="buttons is-centered"><a class="button donate" data-type="wechat"><span class="icon is-small"><i class="fab fa-weixin"></i></span><span>å¾®ä¿¡</span><span class="qrcode"><img src="/img/donates.jpg" alt="å¾®ä¿¡"></span></a></div></div></div><nav class="post-navigation mt-4 level is-mobile"><div class="level-start"><a class="article-nav-prev level level-item link-muted" href="/2021/07/24/Bahamut_daily_bonus_js_example/"><i class="level-item fas fa-chevron-left"></i><span class="level-item">å·´å“ˆå§†ç‰¹è‡ªåŠ¨ç­¾åˆ°è„šæœ¬ï¼ˆé€‚é…/å¼€å‘å®ä¾‹ï¼‰</span></a></div><div class="level-end"><a class="article-nav-next level level-item link-muted" href="/2021/06/08/Surge_network_firewall/"><span class="level-item">ä½¿ç”¨Surgeè„šæœ¬ &amp; é€»è¾‘è§„åˆ™å»ºç«‹è”ç½‘é˜²ç«å¢™</span><i class="level-item fas fa-chevron-right"></i></a></div></nav><div class="card"><div class="card-content"><h3 class="title is-5">è¯„è®º</h3><div id="comment-container"></div><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.css"><script src="https://cdn.jsdelivr.net/npm/gitalk@1.7.2/dist/gitalk.min.js"></script><script>var gitalk = new Gitalk({
            id: "9e7c6c8d6592a3b5bcd758b515f40ba4",
            repo: "NobyDa.github.io",
            owner: "NobyDa",
            clientID: "84cc10757e7c7631cf71",
            clientSecret: "095f8b47cbdb5b1ef38709e44e7186cd951362b9",
            admin: ["NobyDa"],
            createIssueManually: false,
            distractionFreeMode: false,
            perPage: 20,
            pagerDirection: "first",
            
            
            enableHotKey: true,
            language: "zh-CN",
        })
        gitalk.render('comment-container')</script></div></div></div><div class="column column-left is-4-tablet is-3-desktop is-3-widescreen  order-1 is-sticky"><div class="card widget" id="toc" data-type="toc"><div class="card-content"><div class="menu"><h3 class="menu-label">ç›®å½•</h3><ul class="menu-list"><li><a class="level is-mobile" href="#å‰è¨€"><span class="level-left"><span class="level-item">1</span><span class="level-item">å‰è¨€</span></span></a></li><li><a class="level is-mobile" href="#èƒŒæ™¯"><span class="level-left"><span class="level-item">2</span><span class="level-item">èƒŒæ™¯</span></span></a></li><li><a class="level is-mobile" href="#è¿‡ç¨‹"><span class="level-left"><span class="level-item">3</span><span class="level-item">è¿‡ç¨‹</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#ç¬¬ä¸€æ­¥-æŠ“åŒ…"><span class="level-left"><span class="level-item">3.1</span><span class="level-item">ç¬¬ä¸€æ­¥: æŠ“åŒ…</span></span></a></li><li><a class="level is-mobile" href="#ç¬¬äºŒæ­¥-åˆ†æ"><span class="level-left"><span class="level-item">3.2</span><span class="level-item">ç¬¬äºŒæ­¥: åˆ†æ</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#åˆ†ææŸ¥è¯¢ç§¯åˆ†æ¥å£"><span class="level-left"><span class="level-item">3.2.1</span><span class="level-item">åˆ†ææŸ¥è¯¢ç§¯åˆ†æ¥å£</span></span></a></li><li><a class="level is-mobile" href="#åˆ†ææŸ¥è¯¢å•†å“æ¥å£"><span class="level-left"><span class="level-item">3.2.2</span><span class="level-item">åˆ†ææŸ¥è¯¢å•†å“æ¥å£</span></span></a></li><li><a class="level is-mobile" href="#åˆ†æå…‘æ¢å•†å“æ¥å£"><span class="level-left"><span class="level-item">3.2.3</span><span class="level-item">åˆ†æå…‘æ¢å•†å“æ¥å£</span></span></a></li></ul></li><li><a class="level is-mobile" href="#ç¬¬ä¸‰æ­¥-ç¼–å†™è„šæœ¬"><span class="level-left"><span class="level-item">3.3</span><span class="level-item">ç¬¬ä¸‰æ­¥: ç¼–å†™è„šæœ¬</span></span></a><ul class="menu-list"><li><a class="level is-mobile" href="#åº”ç”¨å…¼å®¹"><span class="level-left"><span class="level-item">3.3.1</span><span class="level-item">åº”ç”¨å…¼å®¹</span></span></a></li><li><a class="level is-mobile" href="#å…¨å±€å˜é‡"><span class="level-left"><span class="level-item">3.3.2</span><span class="level-item">å…¨å±€å˜é‡</span></span></a></li><li><a class="level is-mobile" href="#æŸ¥è¯¢ç§¯åˆ†"><span class="level-left"><span class="level-item">3.3.3</span><span class="level-item">æŸ¥è¯¢ç§¯åˆ†</span></span></a></li><li><a class="level is-mobile" href="#æŸ¥è¯¢å•†å“"><span class="level-left"><span class="level-item">3.3.4</span><span class="level-item">æŸ¥è¯¢å•†å“</span></span></a></li><li><a class="level is-mobile" href="#å…‘æ¢å•†å“"><span class="level-left"><span class="level-item">3.3.5</span><span class="level-item">å…‘æ¢å•†å“</span></span></a></li><li><a class="level is-mobile" href="#ç»Ÿä¸€è°ƒç”¨"><span class="level-left"><span class="level-item">3.3.6</span><span class="level-item">ç»Ÿä¸€è°ƒç”¨</span></span></a></li></ul></li><li><a class="level is-mobile" href="#ç¬¬å››æ­¥-é…ç½®ä»»åŠ¡"><span class="level-left"><span class="level-item">3.4</span><span class="level-item">ç¬¬å››æ­¥: é…ç½®ä»»åŠ¡</span></span></a></li></ul></li><li><a class="level is-mobile" href="#ç»“è¯­"><span class="level-left"><span class="level-item">4</span><span class="level-item">ç»“è¯­</span></span></a></li></ul></div></div><script src="/js/toc.js" defer></script></div></div><!--!--></div></div></section><footer class="footer"><div class="container"><div class="level"><div class="level-start"><a class="footer-logo is-block mb-2" href="/"></a><p class="is-size-7"><span id="busuanzi_container_site_uv">Visited by <span id="busuanzi_value_site_uv">0</span> users</span><br><span>&copy; 2024 NobyDa's Blog is</span>Â powered by <a href="https://hexo.io/" target="_blank" rel="noopener">Hexo</a>Â &amp;Â <a href="https://github.com/ppoffice/hexo-theme-icarus" target="_blank" rel="noopener">Icarus</a></p></div><div class="level-end"><div class="field has-addons"><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Creative Commons" href="https://creativecommons.org/"><i class="fab fa-creative-commons"></i></a></p><p class="control"><a class="button is-transparent is-large" target="_blank" rel="noopener" title="Attribution 4.0 International" href="https://creativecommons.org/licenses/by/4.0/"><i class="fab fa-creative-commons-by"></i></a></p></div></div></div></div></footer><script src="https://cdn.jsdelivr.net/npm/jquery@3.3.1/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/moment@2.22.2/min/moment-with-locales.min.js"></script><script src="https://cdn.jsdelivr.net/npm/clipboard@2.0.4/dist/clipboard.min.js" defer></script><script>moment.locale("zh-CN");</script><script>var IcarusThemeSettings = {
            article: {
                highlight: {
                    clipboard: true,
                    fold: 'unfolded'
                }
            }
        };</script><script src="/js/column.js"></script><script src="/js/animation.js"></script><a id="back-to-top" title="å›åˆ°é¡¶ç«¯" href="javascript:;"><i class="fas fa-chevron-up"></i></a><script src="/js/back_to_top.js" defer></script><!--!--><!--!--><!--!--><!--!--><script src="https://cdn.jsdelivr.net/npm/lightgallery@1.6.8/dist/js/lightgallery.min.js" defer></script><script src="https://cdn.jsdelivr.net/npm/justifiedGallery@3.7.0/dist/js/jquery.justifiedGallery.min.js" defer></script><script>window.addEventListener("load", () => {
            if (typeof $.fn.lightGallery === 'function') {
                $('.article').lightGallery({ selector: '.gallery-item' });
            }
            if (typeof $.fn.justifiedGallery === 'function') {
                if ($('.justified-gallery > p > .gallery-item').length) {
                    $('.justified-gallery > p > .gallery-item').unwrap();
                }
                $('.justified-gallery').justifiedGallery();
            }
        });</script><!--!--><!--!--><!--!--><!--!--><!--!--><script src="/js/main.js" defer></script><div class="searchbox"><div class="searchbox-container"><div class="searchbox-header"><div class="searchbox-input-container"><input class="searchbox-input" type="text" placeholder="æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ..."></div><a class="searchbox-close" href="javascript:;">Ã—</a></div><div class="searchbox-body"></div></div></div><script src="/js/insight.js" defer></script><script>document.addEventListener('DOMContentLoaded', function () {
            loadInsight({"contentUrl":"/content.json"}, {"hint":"æƒ³è¦æŸ¥æ‰¾ä»€ä¹ˆ...","untitled":"(æ— æ ‡é¢˜)","posts":"æ–‡ç« ","pages":"é¡µé¢","categories":"åˆ†ç±»","tags":"æ ‡ç­¾"});
        });</script></body></html>